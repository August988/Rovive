!function(){var t={962:function(e,a,t){"use strict";t.r(a);var a=jQuery,F=t.n(a),H=Roblox;document.addEventListener("DOMContentLoaded",function(){var e,a,v=!1,g=F()("#upload-button"),o=F()("#estimate-price-button"),r=F()("#audio-bucket-data"),t=F()("#assetTypeId").val(),n=F()("#captchaEnabled"),i=F()("#captchaToken"),s=F()("#captchaProvider"),c=F()("#upload-fee-item-result-error"),d=F()("#upload-fee-item-result-success"),l=3===parseInt(t,10),l2=4===parseInt(t,10),u=l2?H.EmbeddedUpload.Resources.invalidMeshFile:l?H.EmbeddedUpload.Resources.invalidSoundFile:H.EmbeddedUpload.Resources.invalidImageFile,p=l2?[".obj"]:l?[".mp3"]:[".png",".jpg",".jpeg",".jpe",".bmp",".tga"],f=[2,11,12],m=[11,12],h={verifyCaptcha:"verifyCaptcha",confirmTransaction:"confirmTransaction",declineTransaction:"declineTransaction",insufficientFundsForTransaction:"insufficientFunds"},b={user:"User",group:"Group"};function y(){return!(F()("#file").val()&&!F()("#name").val().trim())||(F()("#name-error").text(H.EmbeddedUpload.Resources.noName),!1)}function w(e,a,t){a&&!v?(e.addClass("btn-primary").removeClass("btn-disabled-primary"),e.removeAttr("disabled")):(e.addClass("btn-disabled-primary").removeClass("btn-primary"),e.attr("disabled","disabled")),e[a||t?"removeClass":"addClass"]("invisible")}function T(e){if(!e.attr("disabled")){w(g,!1,!0);e=F()("#onVerificationPage");if(!e.get(0)||"True"!=e.val()){if(!F()("#file").val())return F()("#file-error").text(H.EmbeddedUpload.Resources.noFile),void w(g,!0,!0);e=F()("#file").val().replace(/^.*[\\\/]/,""),e=e.substr(e.lastIndexOf(".")).toLowerCase();if(-1===F().inArray(e,p))return F()("#file-error").text(u),void w(g,!0,!0);if(!y())return void w(g,!0,!0)}F()("#loading-container").show(),F()("#upload-button").hide(),F()("#cancel-upload-button").hide(),F()("#purchase-amount-message").hide(),(f.includes(x())?function(){c[0].innerHTML="",c[0].classList.add("hidden");var e=F()("#file").val().replace(/^.*[\\\/]/,""),a=e.substr(e.lastIndexOf(".")).toLowerCase(),t=new FormData,n=new Blob([I()],{type:"application/json"});t.append("config",n,"config.json"),n="image/".concat(a.replace(".","")),n=new Blob([F()("#file").prop("files")[0]],{type:n}),t.append(e,n,e+a),F().ajax({type:"POST",url:"".concat(H.EnvironmentUrls.itemConfigurationApi,"/v1/avatar-assets/").concat(x(),"/get-upload-fee"),data:t,contentType:!1,processData:!1,success:function(e){var a;e.canAfford?(e=e.price,a=e,e="null",void 0!==C()&&(e=C()),F().ajax({type:"POST",url:"".concat(H.EnvironmentUrls.itemConfigurationApi,"/v1/avatar-assets/").concat(x(),"/upload-captcha-test?groupId=").concat(e),contentType:!1,processData:!1,success:function(e){!0===e.success?M(a):E(function(e){e?M(a):window.location.reload()})},error:function(){w(g,!0,!0),F()("#upload-button").show(),document.getElementById("upload-form").reset(),c[0].innerHTML="A Captcha Error Occured",c.classList[0].remove("hidden")}})):(F()("#loading-container").hide(),c[0].innerHTML="Insufficient funds",c[0].classList.remove("hidden"))},error:function(e){w(g,!0,!0),F()("#upload-button").show(),document.getElementById("upload-form").reset(),400===e.status?2===e.responseJSON.errors[0].code?L():(F()("#loading-container").hide(),c[0].innerHTML="Please make sure your file is an image",c[0].classList.remove("hidden")):503===e.status||404===e.status?L():(F()("#loading-container").hide(),c[0].innerHTML="An unexpected error occured. Please try again later",c[0].classList.remove("hidden"))}})}:L)()}}function L(){"true"===n.val().toLowerCase()?E(function(e){e?F()("#upload-form").submit():window.location.reload()}):F()("#upload-form").submit()}function x(){return parseInt(t,10)}function C(){var e=F()("#groupId").val(),e=parseInt(e,10);if(!isNaN(e))return e}function U(){var e=F()("#groupId").val();return e&&0<e.length}function I(){var e=H.CurrentUser.userId,a=b.user;U()&&(e=C(),a=b.group);a={name:F()("#name").val(),description:"New clothing asset",creatorTargetId:e,creatorType:a};return JSON.stringify(a)}function E(a){var e={method:h.verifyCaptcha,isGroupUpload:U(),assetTypeId:x(),groupId:C()};window.parent.postMessage(e,"*"),window.addEventListener("message",function(e){e.origin===window.location.origin&&e.data&&e.data.method===h.verifyCaptcha&&(i.val(e.data.captchaToken),s.val(e.data.captchaProvider),a(e.data.success))})}function M(e){e<=0?O():(e={method:h.confirmTransaction,price:e,assetType:x(),isGroupUpload:void 0!==C()},window.parent.postMessage(e,"*"),window.addEventListener("message",function(e){e.origin===window.location.origin&&(e.data&&e.data.method===h.declineTransaction&&window.location.reload(),e.data&&e.data.method===h.confirmTransaction&&O())}))}function O(){var e=F()("#file").val().replace(/^.*[\\\/]/,""),a=e.substr(e.lastIndexOf(".")).toLowerCase(),t=new FormData,n=new Blob([I()],{type:"application/json"});t.append("config",n,"config.json");n="image/".concat(a.replace(".","")),n=new Blob([F()("#file").prop("files")[0]],{type:n});t.append(e,n,e+a);a={captchaToken:i.val(),captchaProvider:s.val()},a=new Blob([JSON.stringify(a)],{type:"application/json"});t.append("captcha-token-request",a,"captcha-token-request.json"),F().ajax({type:"POST",url:"".concat(H.EnvironmentUrls.itemConfigurationApi,"/v1/avatar-assets/").concat(x(),"/upload"),data:t,contentType:!1,processData:!1,success:function(e){F()("#loading-container").hide(),document.getElementById("upload-fee-confirmation-link").href="".concat(H.EnvironmentUrls.websiteUrl,"/catalog/").concat(e.assetId),d[0].classList.remove("hidden"),w(g,!0,!0),window.top.location.reload()},error:function(e){w(g,!0,!0),F()("#upload-button").show(),document.getElementById("upload-form").reset(),400===e.status?(F()("#loading-container").hide(),7===e.responseJSON.errors[0].code?c[0].innerHTML="Upload failed. Did you use the template?":16===e.responseJSON.errors[0].code&&(c[0].innerHTML="Asset name was moderated. Please try again.")):402===e.status?(F()("#loading-container").hide(),c[0].innerHTML="Insufficient funds."):403===e.status&&15===e.responseJSON.errors[0].code?(F()("#loading-container").hide(),c[0].innerHTML="Captcha required."):500===e.status&&12===e.responseJSON.errors[0].code?m.includes(x())?(F()("#loading-container").hide(),c[0].innerHTML="Upload failed. Did you use the template?"):(F()("#loading-container").hide(),c[0].innerHTML="Upload failed. Please try again later."):(F()("#loading-container").hide(),c[0].innerHTML="An unexpected error occured. Please try again later"),c[0].classList.remove("hidden")}})}f.includes(x())&&(e=new FormData,a=new Blob([I()],{type:"application/json"}),e.append("config",a,"config.json"),a=new Blob,e.append("GetUploadFeePrice",a,"GetUploadFeePrice".concat(".png")),F().ajax({type:"POST",url:"".concat(H.EnvironmentUrls.itemConfigurationApi,"/v1/avatar-assets/").concat(x(),"/get-upload-fee"),data:e,contentType:!1,processData:!1,success:function(e){0<e.price&&(g[0].innerHTML="Upload for ".concat(e.price," Robux"))}})),l&&"true"===F()("#isOggUploadEnabled").val().toLowerCase()&&p.push(".ogg"),F()("ul.nav-pills li").click(function(e){e.preventDefault(),F()(".nav-pills li.active").removeClass("active"),F()(this).addClass("active");e=F()(this).data("asset-type-id");F()("input[name=assetTypeId]").val(e)}),F()("#file").change(function(){var e,a;F()("#upload-result").remove(),F()("#file-error").text(""),F()("#name-error").text(""),F()("#file").val()&&(a=(e=F()("#file").val().replace(/^.*[\\\/]/,"")).substr(e.lastIndexOf(".")).toLowerCase(),-1===F().inArray(a,p)?F()("#file-error").text(u):(F()("#name").val(e.slice(0,-a.length)),F()("#name").select()))}),F()("#name").focusout(y),g.click(function(){T(F()(this))}),o.click(function(){F()(this).attr("disabled")||l&&(w(o,!1,!0),F().ajax({type:"POST",url:H.Endpoints.getAbsoluteUrl("/build/verifyaudio"),data:new FormData(F()("form")[0]),contentType:!1,processData:!1,success:function(e){F()("#file-error").text(e.message),e.price&&g.text("Purchase for ".concat(e.price," Robux")),w(g,!e.message&&e.canAfford,!!e.price),w(o,!1,!e.price)},error:function(){w(o,!0,!0)}}))});var P,j=F()("#selectedPlaceId",parent.document);!j||(P=F()("#badge-place-select"))&&0<P.children("option").length&&(j=j.val(),0<F()("#badge-place-select option[value=".concat(j,"]")).length&&P.val(j));for(var S=[],A=["shortsoundeffect","longsoundeffect","music","longmusic"],D=0;D<A.length;D++)r.data("".concat(A[D],"-enabled"))&&S.push({size:r.data("".concat(A[D],"-size")),price:r.data("".concat(A[D],"-price"))});0<S.length&&F()("#file[accept='audio/*']").change(function(){F()("#file-error").text(""),w(o,!1,!0),w(g,!1,!1);var e=this.files&&this.files[0];if(e){var a=!1;if(e.size<1)F()("#file-error").text(H.EmbeddedUpload.Resources.fileIsEmpty);else if(e.size<=r.data("max-audio-size"))for(var t=0;t<S.length;t++){var n=S[t];if(e.size<=n.size){a=!0;break}}else F()("#file-error").text(H.EmbeddedUpload.Resources.fileTooLarge);g.data("freeaudio-enabled")?w(g,!0,!0):w(o,a,!0)}}),function e(){var a,t,n,o,r,i,s,c,d,l,u,p,f=document.querySelector("form#upload-form"),m=window.parent.document.querySelector("[data-audio-alert]");m&&(a=(o=f.dataset).audioUploadRateLimitUrl,r=o.uploadQuotasFailedToLoad,u=o.uploadQuotasQuotasCount,i=o.uploadQuotasQuotas0Capacity,s=o.uploadQuotasQuotas0Duration,d=o.uploadQuotasQuotas0ExpirationTime,c=o.uploadQuotasQuotas0Usage,t="",n=!1,!(p="False"!==r)&&0==+u||(f=+i,o=s,r=+c,0<(u=new Date(d).getTime()-Date.now())&&(i=Math.floor(u/864e5),s=Math.floor(u%864e5/36e5),c=Math.floor(u%36e5/6e4),d=Math.floor(u%6e4/1e3),u=!1,0<i?(l="".concat(i," day"),u=1<i):0<s?(l="".concat(s," hour"),u=1<s):0<c?(l="".concat(c," minute"),u=1<c):0<d&&(l="".concat(d," second"),u=1<d),l&&u&&(l+="s"),t='\n      <div class="alert-info">\n        Audio uploads are temporarily disabled.\n      </div>',!p&&0<f&&(p="",0==r?p="You get ".concat(f," per ").concat(o,".<br />"):r<f?p="You have ".concat(f-r," left until ").concat(l," from now.<br />"):(n=!0,p="You've reached your audio upload limit.<br />It refreshes in ".concat(l,"."),setTimeout(e,1e3)),t='\n          <div class="alert-'.concat(n?"info":"success",'">\n            Audio uploads are now free.\n            ').concat(p,'\n            (<a href="').concat(a,'">Learn more</a>)<br />\n          </div>')))),w(g,!(v=n),!0),m.innerHTML=t)}()})}},n={};function o(e){if(n[e])return n[e].exports;var a=n[e]={exports:{}};return t[e](a,a.exports,o),a.exports}o.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(a,{a:a}),a},o.d=function(e,a){for(var t in a)o.o(a,t)&&!o.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})},o.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},window.AssetsUploader=o(962)}();

/* Bundle detector */
window.Roblox && window.Roblox.BundleDetector && window.Roblox.BundleDetector.bundleDetected("AssetsUploader");